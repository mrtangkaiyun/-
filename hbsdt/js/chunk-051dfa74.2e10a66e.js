(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-051dfa74"],{"728d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-header-wrapper",[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("search-bar",{ref:"searchbar",attrs:{data:t.searchData},on:{search:t.clickSearch,add:t.clickAdd}}),a("a-table",{attrs:{columns:t.columns,dataSource:t.table.data,rowKey:"id",size:t.table.size,loading:t.table.loading,pagination:t.pagination,scroll:{x:900}},on:{change:t.handleTabChange},scopedSlots:t._u([{key:"index",fn:function(e,a,i){return[t._v(" "+t._s(i+1)+" ")]}},{key:"action",fn:function(e,i){return a("span",{},[a("a-button",{attrs:{type:"primary",shape:"circle",icon:"form"},on:{click:function(e){return t.clickUpdate(i)}}}),a("a-divider",{attrs:{type:"vertical"}}),a("a-button",{attrs:{type:"primary",shape:"circle",icon:"info"},on:{click:function(e){return t.clickDetail(i)}}})],1)}}])})],1)]),t.add.visiable?a("add",{attrs:{data:t.add.data},on:{add:t.refresh,edit:t.fetchData},model:{value:t.add.visiable,callback:function(e){t.$set(t.add,"visiable",e)},expression:"add.visiable"}}):t._e()],1)},o=[],n=a("5530"),s=[{title:"序号",dataIndex:"index",width:80,scopedSlots:{customRender:"index"}},{title:"师傅姓名",dataIndex:"publisherName",width:120,key:"publisherName"},{title:"任务名称",dataIndex:"taskName",width:100,key:"taskName"},{title:"任务发布日期",dataIndex:"startTime",width:150,key:"startTime"},{title:"任务截止日期",dataIndex:"endTime",width:150,key:"endTime"},{title:"任务执行人",dataIndex:"taskExecutorName",width:100,key:"taskExecutorName"},{title:"任务状态",dataIndex:"taskStatus",width:90,key:"taskStatus"},{title:"操作",key:"action",fixed:"right",width:160,scopedSlots:{customRender:"action"}}],r=[[{type:"input",key:"taskName",label:"任务名称",placeholder:"请输入"},{type:"select",key:"taskStatusVo",label:"任务状态",placeholder:"请选择",options:[{label:"未开始",value:"1"},{label:"已开始",value:"2"},{label:"已结束",value:"3"}]},{type:"search",name:"查询"},{type:"reset",name:"重置"}],[]],c=[{title:"序号",dataIndex:"idx",width:80,scopedSlots:{customRender:"idx"}},{title:"文件名称",dataIndex:"name",width:200,key:"name"},{title:"操作",key:"action",fixed:"right",width:160,scopedSlots:{customRender:"action"}}],l=a("7eae"),d=a("5ff1"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{staticClass:"page-modal",attrs:{afterClose:t.closeDialog,title:t.dialog.title,footer:null,keyboard:!1,maskClosable:!1,width:"1000px"},model:{value:t.dialog.visiable,callback:function(e){t.$set(t.dialog,"visiable",e)},expression:"dialog.visiable"}},[a("a-form-model",{ref:"form",attrs:{model:t.formInit,loading:"","wrapper-col":{span:22}}},[a("a-row",[a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"任务名称",prop:"taskName"}},[a("a-input",{attrs:{disabled:"",placeholder:"请输入"},model:{value:t.taskExecutorObj.taskName,callback:function(e){t.$set(t.taskExecutorObj,"taskName",e)},expression:"taskExecutorObj.taskName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"任务截至日期",prop:"endTime"}},[a("a-date-picker",{attrs:{disabled:""},model:{value:t.taskExecutorObj.endTime,callback:function(e){t.$set(t.taskExecutorObj,"endTime",e)},expression:"taskExecutorObj.endTime"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"发布日期",prop:"startTime"}},[a("a-date-picker",{attrs:{disabled:""},model:{value:t.taskExecutorObj.startTime,callback:function(e){t.$set(t.taskExecutorObj,"startTime",e)},expression:"taskExecutorObj.startTime"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"发布人",prop:"publisher"}},[a("a-input",{staticStyle:{display:"none"},attrs:{placeholder:"请输入"},model:{value:t.taskExecutorObj.publisher,callback:function(e){t.$set(t.taskExecutorObj,"publisher",e)},expression:"taskExecutorObj.publisher"}}),a("a-input",{attrs:{disabled:"",placeholder:"请输入",value:t.taskExecutorObj.publisherName}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"任务状态",prop:"publisher"}},[a("a-input",{attrs:{disabled:"",placeholder:"请输入"},model:{value:t.taskExecutorObj.taskStatus,callback:function(e){t.$set(t.taskExecutorObj,"taskStatus",e)},expression:"taskExecutorObj.taskStatus"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"任务执行人",prop:"taskExecutor"}},[a("a-input",{attrs:{disabled:"",placeholder:"请输入"},model:{value:t.taskExecutorObj.studentName,callback:function(e){t.$set(t.taskExecutorObj,"studentName",e)},expression:"taskExecutorObj.studentName"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:15}},[a("a-form-model-item",{attrs:{label:"任务要求",prop:"taskDemand"}},[a("a-textarea",{staticStyle:{width:"98%"},attrs:{disabled:"",placeholder:"请输入文本...",autosize:{maxRows:5,minRows:5}},model:{value:t.taskExecutorObj.taskDemand,callback:function(e){t.$set(t.taskExecutorObj,"taskDemand",e)},expression:"taskExecutorObj.taskDemand"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:15}},[a("a-form-model-item",{attrs:{label:"执行反馈说明"}},[a("a-textarea",{staticStyle:{width:"98%"},attrs:{disabled:t.isDetail,placeholder:"请输入文本...",autosize:{maxRows:5,minRows:5}},model:{value:t.formInit.feedback,callback:function(e){t.$set(t.formInit,"feedback",e)},expression:"formInit.feedback"}})],1)],1)],1),t.isEdit||t.isDetail?a("a-row",[a("a-col",{attrs:{span:15}},[a("a-form-model-item",{attrs:{label:"结果资料"}},[a("div",{staticStyle:{width:"98%"}},[a("a-button",{directives:[{name:"show",rawName:"v-show",value:!t.isDetail,expression:"!isDetail"}],on:{click:t.importFile}},[a("a-icon",{attrs:{type:"upload"}}),t._v("文件上传 ")],1),a("a-upload",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"upxlsx",attrs:{name:"file",multiple:!0,customRequest:t.customRequest,accept:"doc,.pdf,.docx,.csv, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),t._v("文件上传 ")],1)],1),a("a-table",{attrs:{columns:t.columns,dataSource:t.table.data,rowKey:"id",loading:t.table.loading},scopedSlots:t._u([{key:"action",fn:function(e,i){return a("span",{},[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownLoad(i)}}},[t._v("下载")]),t.isEdit?a("a-divider",{attrs:{type:"vertical"}}):t._e(),t.isEdit?a("popconfirm-button",{attrs:{data:i},on:{click:t.deleteWordName}}):t._e()],1)}}],null,!1,2817524803)})],1)])],1)],1):t._e(),t.isDetail?t._e():a("div",{staticClass:"text-center"},[a("a-button",{staticClass:"margin-l-20",attrs:{type:"primary",loading:t.button.loading},on:{click:t.handleSubmit}},[t._v("保存")]),a("a-button",{on:{click:t.closeDialog}},[t._v(" 关闭 ")])],1)],1)],1)],1)},m=[],p=(a("d81d"),a("ffcb")),b=a("4fb8"),f=a("ca00"),h=a("6a8e"),k={mixins:[p["a"],b["a"],d["a"]],data:function(){return{taskExecutorObj:{},formInit:{feedback:null},columns:c,issuerOptions:h["e"]}},computed:{isDetail:function(){var t=this.data.type;return"detail"===t},isEdit:function(){var t=this.data.type;return"edit"===t}},created:function(){var t=this.data.type,e="add"===t?"任务发布":"edit"===t?"任务编辑":"任务详情";this.$setKeyValue(this.dialog,{title:e,visiable:!0}),"edit"!==t&&"detail"!==t||this.fetchInfo()},methods:{fetchInfo:function(){var t=this,e=this.data.obj;Object(l["d"])(e.id).then((function(e){var a=e.code,i=e.data;0===a&&(t.table.data=i.wordNames?i.wordNames.map((function(t,e){return{idx:e+1,name:t}})):[],t.taskExecutorObj=Object(n["a"])({studentName:i.taskExecutorName,studentId:i.taskExecutor},i),t.originalData=t.$copy(i),t.$setOriginalKV(t.formInit,i))}))},confirmSelected:function(t){this.taskExecutorObj=t,this.formInit.taskExecutor=t.studentId},clickDownLoad:function(t){var e=this.data.obj;Object(l["b"])({id:e.id,row:t.idx}).then((function(t){if(t){var e="结果资料";Object(f["a"])(t,e).then((function(){}))}}))},deleteWordName:function(t){var e=this,a=this.data.obj;Object(l["f"])({id:a.id,row:t.idx}).then((function(t){var a=t.code;0===a&&(e.$message.success("删除成功"),e.fetchInfo())}))},importFile:function(){this.$refs["upxlsx"].$el.getElementsByTagName("input")[0].click()},customRequest:function(t){var e=this,a=this.data.obj,i=new FormData;i.append("file",t.file),i.append("id",a.id),Object(l["a"])(i).then((function(t){var a=t.code,i=t.message;0===a&&(e.fetchInfo(),e.$message.success(i||"上传成功"))}))},handleSubmit:function(t){var e=this;t.preventDefault(),this.$refs.form.validate((function(t){if(t){var a=e.data,i=a.type,o=a.obj,s=Object(n["a"])({},e.formInit);if("edit"===i&&e.$compareObjValue(e.originalData,s))return void e.$message.warning("数据没有任何修改");e.$setKeyValue(e.button,{loading:!0,text:"提交中"}),"edit"===i&&(s.id=o.id,Object(l["e"])(s).then((function(t){return e.process(t)})))}else e.$message.warning("请完善上面必填信息")}))}}},x=k,v=a("2877"),j=Object(v["a"])(x,u,m,!1,null,"0b216d29",null),g=j.exports,w=a("5880"),y={name:"Task",mixins:[d["a"]],components:{Add:g},data:function(){return{columns:s,searchData:r}},computed:Object(n["a"])({},Object(w["mapGetters"])(["userInfo"])),created:function(){this.fetchData()},methods:{fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.table.loading){var a=this.pagination,i=a.current,o=a.pageSize;e.pageNum=i,e.pageSize=o,this.table.loading=!0,e.id=this.userInfo.id,Object(l["j"])(e).then((function(e){var a=e.code,i=e.data;t.table.loading=!1,0===a&&(t.pagination.total=i.total,t.table.data=i.rows)}))}},clickDetail:function(t){this.$setKeyValue(this.add,{visiable:!0,data:{type:"detail",obj:t}})}}},O=y,E=Object(v["a"])(O,i,o,!1,null,"cb34f436",null);e["default"]=E.exports},"7eae":function(t,e,a){"use strict";a.d(e,"j",(function(){return n})),a.d(e,"d",(function(){return s})),a.d(e,"g",(function(){return r})),a.d(e,"h",(function(){return c})),a.d(e,"c",(function(){return l})),a.d(e,"i",(function(){return d})),a.d(e,"e",(function(){return u})),a.d(e,"a",(function(){return m})),a.d(e,"f",(function(){return p})),a.d(e,"b",(function(){return b}));var i=a("b775"),o="/skill/apprenticeship/task";function n(t){return Object(i["b"])({url:"".concat(o,"/taskList"),method:"get",params:t})}function s(t){return Object(i["b"])({url:"".concat(o,"/queryInfo?id=").concat(t),method:"get"})}function r(t){return Object(i["b"])({url:"".concat(o,"/add"),method:"post",data:t})}function c(t){return Object(i["b"])({url:"".concat(o,"/update"),method:"post",data:t})}function l(t){return Object(i["b"])({url:"".concat(o,"/deleteById"),method:"get",params:t})}function d(t){return Object(i["b"])({url:"".concat(o,"/updateById"),method:"get",params:t})}function u(t){return Object(i["b"])({url:"".concat(o,"/updateTask"),method:"post",params:t})}function m(t){return Object(i["b"])({url:"".concat(o,"/upload"),method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})}function p(t){return Object(i["b"])({url:"".concat(o,"/deleteWordName"),method:"get",params:t})}function b(t){return Object(i["b"])({url:"".concat(o,"/download"),method:"post",params:t,responseType:"blob"})}}}]);